<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>marcus - marcus</title><link>https://marcus.means.no/https://marcus.means.no/</link><description>All entries in marcus on marcus</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><copyright>Code released under the MIT license.</copyright><lastBuildDate>Sun, 25 May 2025 00:00:00 +0000</lastBuildDate><atom:link href="https://marcus.means.no/" rel="self" type="application/rss+xml"/><item><title>Building a Grafana Kiosk With Nixos</title><link>https://marcus.means.no/post/2025-05-25-building-a-grafana-kiosk-with-nixos/</link><pubDate>Sun, 25 May 2025 00:00:00 +0000</pubDate><author>marcus@means.no - Marcus Ramberg</author><guid>https://marcus.means.no/post/2025-05-25-building-a-grafana-kiosk-with-nixos/</guid><description>&lt;p>At work, we&amp;rsquo;re passionate about data diven decisions. Among others we use
&lt;a href="https://grafana.com/">Grafana&lt;/a> to visualize our key metrics .
We recently acquired a number of dual TV stands for our teams, and we wanted to use them to display our Grafana dashboards.
After experimenting with PI4s and finding the 4k support lacking, we decided to use go for a n100-based mini pc model.
Flashing and maintaining a number of pcs can be painful, so we desided to use a declarative setup and flash stateless
&lt;a href="https://nixos.org">NixOS&lt;/a> configurations. In order to bootstrap the PCs as quickly as possible, we use
&lt;a href="https://github.com/chrillefkr/nixos-unattended-installer">nixos-unattended-installer&lt;/a> and &lt;a href="https://github.com/nix-community/disko">disko&lt;/a>.&lt;/p>
&lt;p>From USB boot to installed on disk it&amp;rsquo;s less than 10 minutes, and we can bake in all the configuration we need,
including team credentials and Grafana playlists to render. Using ssh we can also easily push new configurations if
needed.&lt;/p>
&lt;h2 id="disko">Disko&lt;/h2>
&lt;p>When you have a set of identical machines, &lt;a href="https://github.com/nix-community/disko">disko&lt;/a> is awesome for partitioning
and formatting disks. It&amp;rsquo;s a declarative way of configuring your partition layout, and it integrates great with
nixos-unattended-installer.&lt;/p>
&lt;p>First we need to add the disko module from the flake to our nixos system configuration
partitions.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-nix" data-lang="nix">&lt;span style="display:flex;">&lt;span> cs &lt;span style="color:#f92672">=&lt;/span> nixpkgs&lt;span style="color:#f92672">.&lt;/span>lib&lt;span style="color:#f92672">.&lt;/span>nixosSystem {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> system &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;x86_64-linux&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> modules &lt;span style="color:#f92672">=&lt;/span> [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> disko&lt;span style="color:#f92672">.&lt;/span>nixosModules&lt;span style="color:#f92672">.&lt;/span>disko
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">...&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>then we set up actual partitions&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-nix" data-lang="nix">&lt;span style="display:flex;">&lt;span> disko&lt;span style="color:#f92672">.&lt;/span>devices&lt;span style="color:#f92672">.&lt;/span>disk&lt;span style="color:#f92672">.&lt;/span>nvme &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> device &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;/dev/nvme0n1&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> type &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;disk&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> content &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> type &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;gpt&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> partitions &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ESP &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> type &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;EF00&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> size &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;500M&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> content &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> type &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;filesystem&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> format &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;vfat&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> mountpoint &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;/boot&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> root &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> size &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;100%&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> content &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> type &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;filesystem&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> format &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;ext4&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> mountpoint &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;/&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>As you can see we&amp;rsquo;re just setting up a small UEFI esp partition and allocating the rest of the space to root.&lt;/p>
&lt;h2 id="nioxs-unattended-installer">nioxs-unattended-installer&lt;/h2>
&lt;p>This is a major win for us, as it&amp;rsquo;s a completely hands off installation process. Unfortunately we have to disable secure
boot on the machines in the bios, if I had to do a lot more of them I&amp;rsquo;d probably automate the process using something
like a PI sending usb keyboard keystrokes with something like the &lt;a href="https://pikvm.org/">pikvm&lt;/a> recorder.&lt;/p>
&lt;p>We just have to use their disko wrapper around the defined nixos configuration:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-nix" data-lang="nix">&lt;span style="display:flex;">&lt;span>cs-installer &lt;span style="color:#f92672">=&lt;/span> unattended-installer&lt;span style="color:#f92672">.&lt;/span>lib&lt;span style="color:#f92672">.&lt;/span>diskoInstallerWrapper self&lt;span style="color:#f92672">.&lt;/span>nixosConfigurations&lt;span style="color:#f92672">.&lt;/span>cs { };
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="graphics-environment">Graphics environment&lt;/h2>
&lt;p>In this example we chose xfce4 as a desktop environment, it&amp;rsquo;s lightweight and supports multiple monitors in a way that&amp;rsquo;s
pleasing to us. Having this also allows the team to debug any local issues like network problems, but if you want a more
locked down environment you could also use something like cage or i3 and not support any system access.
The nixos configuration looks something like this:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-nix" data-lang="nix">&lt;span style="display:flex;">&lt;span> services&lt;span style="color:#f92672">.&lt;/span>xserver &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> enable &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> desktopManager&lt;span style="color:#f92672">.&lt;/span>xfce &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> enable &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> enableScreensaver &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">false&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> displayManager &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> lightdm &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> enable &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> greeters&lt;span style="color:#f92672">.&lt;/span>tiny&lt;span style="color:#f92672">.&lt;/span>enable &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>We have to setup the DM to ensure automatic login.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-nix" data-lang="nix">&lt;span style="display:flex;">&lt;span>services&lt;span style="color:#f92672">.&lt;/span>displayManager &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> defaultSession &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;xfce4&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> autoLogin&lt;span style="color:#f92672">.&lt;/span>user &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;kiosk&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="grafana-kiosk">Grafana Kiosk&lt;/h2>
&lt;h3 id="systemd-services">Systemd services&lt;/h3>
&lt;p>The recommended way to run grafana kiosk is to use a systemd service. happily that is easy enough in nixos. This also
ensures that the kiosk app is automatically restarted if it should crash.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-nix" data-lang="nix">&lt;span style="display:flex;">&lt;span> systemd&lt;span style="color:#f92672">.&lt;/span>services &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> grafana-kiosk-1 &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> enable &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> after &lt;span style="color:#f92672">=&lt;/span> [ &lt;span style="color:#e6db74">&amp;#34;network.target&amp;#34;&lt;/span> ];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> wantedBy &lt;span style="color:#f92672">=&lt;/span> [ &lt;span style="color:#e6db74">&amp;#34;graphical.target&amp;#34;&lt;/span> ];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> description &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;Grafana Kiosk Screen 1&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> serviceConfig &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> User &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;kiosk&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Restart &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;always&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> RestartSec &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;20&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> environment &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> DISPLAY &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;:0&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> XAUTHORITY &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;/home/kiosk/.Xauthority&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> serviceConfig &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Type &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;simple&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ExecStartPre &lt;span style="color:#f92672">=&lt;/span> [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>pkgs&lt;span style="color:#f92672">.&lt;/span>xorg&lt;span style="color:#f92672">.&lt;/span>xset&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">/bin/xset s off&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>pkgs&lt;span style="color:#f92672">.&lt;/span>xorg&lt;span style="color:#f92672">.&lt;/span>xset&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">/bin/xset s noblank&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>pkgs&lt;span style="color:#f92672">.&lt;/span>xorg&lt;span style="color:#f92672">.&lt;/span>xset&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">/bin/xset -dpms&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ExecStart &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;&lt;/span>&lt;span style="color:#e6db74">${&lt;/span>pkgs&lt;span style="color:#f92672">.&lt;/span>grafana-kiosk&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">/bin/grafana-kiosk com -URL &lt;/span>&lt;span style="color:#e6db74">${&lt;/span>builtins&lt;span style="color:#f92672">.&lt;/span>elemAt settings&lt;span style="color:#f92672">.&lt;/span>playlists &lt;span style="color:#ae81ff">0&lt;/span>&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>In order to run multiple of these, you&amp;rsquo;d start the second one with a offset param to grafana -kiosk like
-window-position 3841,0 for&lt;/p>
&lt;p>Note that you&amp;rsquo;ll probably need to authentication to your Grafana instance, see the
&lt;a href="https://github.com/grafana/grafana-kiosk">README&lt;/a> for details on various auth schemes. In our case we use IAP and
provide a service account with minimal permissions per team. You might also want to adjust RestartSec for your setup for
faster startup or to avoid restart back-off.&lt;/p>
&lt;p>Other than that it&amp;rsquo;s pretty much stock nixos config, like setting up networking and adding the kiosk user and enabling
openssh for remote management. I&amp;rsquo;ll leave that as an exercise for the reader. The &lt;a href="https://nixos.org/manual/nixos/stable/#ch-configuration">nixos manual&lt;/a>
should come in handy.&lt;/p>
&lt;p>Once you have this configuration in a flake, you can build a iso image for flashing using something like&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-nix" data-lang="nix">&lt;span style="display:flex;">&lt;span>nix build &lt;span style="color:#e6db74">&amp;#34;path:.#nixosConfigurations.cs-installer.config.system.build.isoImage&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>In this case we&amp;rsquo;re using path: to be able to include credentials without adding them to the git index.&lt;/p>
&lt;h2 id="future-improvements">Future improvements&lt;/h2>
&lt;ul>
&lt;li>setting up a tunnel for management using something like &lt;a href="https://github.com/cloudflare/cloudflared">cloudflared&lt;/a> or
&lt;a href="https://tailscale.net/">tailscale&lt;/a>. nix already has nice modules for configuring both of these.&lt;/li>
&lt;li>Using something like &lt;a href="https://github.com/serokell/deploy-rs">deploy-rs&lt;/a> or
(colmena](&lt;a href="https://github.com/zhaofengli/colmena">https://github.com/zhaofengli/colmena&lt;/a>) to do OTA updates.&lt;/li>
&lt;li>Using external secrets management with something like &lt;a href="https://github.com/Mic92/sops-nix">sops-nix&lt;/a> to allow using a
&lt;a href="https://www.maxdaten.io/2023-12-11-deploy-sops-secrets-with-nix">cloud kvm&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Fosdem 2025 Conference Report</title><link>https://marcus.means.no/post/2025-02-05-fosdem-conference-report/</link><pubDate>Wed, 05 Feb 2025 00:00:00 +0000</pubDate><author>marcus@means.no - Marcus Ramberg</author><guid>https://marcus.means.no/post/2025-02-05-fosdem-conference-report/</guid><description>&lt;p>Attended Fosdem again this year and had a blast. Made a conference report for work, so figure I
might as well post it here too. :)&lt;/p></description></item><item><title>Managing Hugo With devenv</title><link>https://marcus.means.no/post/2024-01-21-managing-hugo-with-devenv/</link><pubDate>Sun, 21 Jan 2024 00:00:00 +0000</pubDate><author>marcus@means.no - Marcus Ramberg</author><guid>https://marcus.means.no/post/2024-01-21-managing-hugo-with-devenv/</guid><description>&lt;p>I am using the &lt;a href="https://gohugo.io/">Hugo&lt;/a> static site generator to generate this blog. I am also using
&lt;a href="https://devenv.sh">devenv&lt;/a> to manage my development environments. This also includes the
&lt;a href="https://github.com/marcusramberg/blog/">blog&lt;/a>. This ensures I can easily build and run the blog locally, and keep up to
date with the latest Hugo version, without having to install anything on my host system. Devenv also provides easy
integration with &lt;a href="https://pre-commit.com/">pre-commit&lt;/a> to allow linting of the markdown files, and CI integration with
GitHub Actions.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-nix" data-lang="nix">&lt;span style="display:flex;">&lt;span> pre-commit&lt;span style="color:#f92672">.&lt;/span>hooks &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> actionlint&lt;span style="color:#f92672">.&lt;/span>enable &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> markdownlint&lt;span style="color:#f92672">.&lt;/span>enable &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Devenv activates the environment when I enter the directory, and deactivates it when I leave it. through the use of
&lt;code>direnv&lt;/code>.This ensures I have the
correct version of Hugo available when I am working on the blog.&lt;/p>
&lt;p>Devenv is also convenient for managing small shell scripts. I have a mkpost script that creates a new post for me:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-nix" data-lang="nix">&lt;span style="display:flex;">&lt;span> mkpost&lt;span style="color:#f92672">.&lt;/span>exec &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> POST=content/post/$(date +%Y-%m-%d)-$1.md
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> hugo new $POST
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> nvim $POST
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> git add $POST
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> git commit -m&amp;#34;feat: Add $POST&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> &amp;#39;&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>as well as a simple script to add a image from my clipboard to the blog:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-nix" data-lang="nix">&lt;span style="display:flex;">&lt;span> pasteimg&lt;span style="color:#f92672">.&lt;/span>exec &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#39;&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> FILE=static/images/$(date +%Y-%m-%d)-$1.png
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> if [ -x &amp;#34;$(command -v pngpaste)&amp;#34; ]; then
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> pngpaste $FILE
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> echo &amp;#34;&amp;lt;img src=\&amp;#34;/images/$(basename $FILE)\&amp;#34; width=700/&amp;gt;&amp;#34; | pbcopy
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> else
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> xclip -selection clipboard -t image/png -o &amp;gt; $FILE
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> echo &amp;#34;&amp;lt;img src=\&amp;#34;/images/$(basename $FILE)\&amp;#34; width=700/&amp;gt;&amp;#34; | xclip -selection clipboard
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> fi
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> &amp;#39;&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>This is super convenient for adding screenshots to the blog, and keeps those screenshots in my environment only while
I&amp;rsquo;m working on the blog.&lt;/p>
&lt;img alt="screenshot" src="https://marcus.means.no/images/2024-01-21-screenshot.png" width=700/>
&lt;p>If you&amp;rsquo;re interested in using devenv, check out the &lt;a href="https://devenv.sh/getting-started/">getting started guide&lt;/a>, and my
devenv &lt;a href="https://github.com/marcusramberg/blog/blob/master/devenv.nix">configuration&lt;/a> for using it with hugo.&lt;/p></description></item><item><title>Easily Run LLMs on nixOS</title><link>https://marcus.means.no/post/2024-01-02-easily-run-llms-on-nixos/</link><pubDate>Tue, 02 Jan 2024 00:00:00 +0000</pubDate><author>marcus@means.no - Marcus Ramberg</author><guid>https://marcus.means.no/post/2024-01-02-easily-run-llms-on-nixos/</guid><description>&lt;p>With the recent AI craze, it&amp;rsquo;s fun to play with local models. I like &lt;a href="https://ollama.ai/">ollama&lt;/a>,
which lets you easily download and interact with various models. Thanks to this
recently merged &lt;a href="https://github.com/NixOS/nixpkgs/pull/277442">PR&lt;/a>, it&amp;rsquo;s now trivial to run your own ollama
service on nixos:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-nix" data-lang="nix">&lt;span style="display:flex;">&lt;span>services&lt;span style="color:#f92672">.&lt;/span>ollama&lt;span style="color:#f92672">.&lt;/span>enable &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Adding this to your host config and rebuilding is all it takes to start the service,
and you can then interact with it via the cli or rest interface. For instance to talk
to the &lt;a href="https://mistral.ai/product/">mistral&lt;/a> model, you can do:&lt;/p>
&lt;img src="https://marcus.means.no/images/2024-01-02-mistral.png" width="720" alt="ollama run mistral"/>
&lt;p>On first run it will automatically download the model, and then you can interact with it.
They support a &lt;a href="https://ollama.ai/library/">bunch of models&lt;/a>, so have fun exploring! If you
are of that inclination, there&amp;rsquo;s also a &lt;a href="https://github.com/nomnivore/ollama.nvim">neovim plugin&lt;/a>.&lt;/p></description></item><item><title>Are WAFs worth it?</title><link>https://marcus.means.no/post/2023-11-13-are-wafs-worth-it/</link><pubDate>Mon, 13 Nov 2023 23:25:59 +0100</pubDate><author>marcus@means.no - Marcus Ramberg</author><guid>https://marcus.means.no/post/2023-11-13-are-wafs-worth-it/</guid><description>&lt;p>Interesting article which discourages the use of web application firewalls. I feel they have some pretty solid
arguments.&lt;/p></description></item><item><title>Changesets now!</title><link>https://marcus.means.no/post/2023-11-05-changesets-now/</link><pubDate>Sun, 05 Nov 2023 10:02:42 +0100</pubDate><author>marcus@means.no - Marcus Ramberg</author><guid>https://marcus.means.no/post/2023-11-05-changesets-now/</guid><description>&lt;p>We have indeed worked around some or these problems, by automatically dismissing stale reviews, mostly
having single commit PRs and so on, but I strongly agree this model would just be better.&lt;/p></description></item><item><title>First Experiences With Homely Alarm</title><link>https://marcus.means.no/post/2023-11-04-first-experiences-with-homely-alarm/</link><pubDate>Sat, 04 Nov 2023 00:00:00 +0000</pubDate><author>marcus@means.no - Marcus Ramberg</author><guid>https://marcus.means.no/post/2023-11-04-first-experiences-with-homely-alarm/</guid><description>&lt;p>For the last few years, we&amp;rsquo;ve had managed alarm service from &lt;a href="https://www.sectoralarm.no">Sector Alarm&lt;/a>. It&amp;rsquo;s mostly
been OK, but the price has been increasing every year, and they never upgrade our components,
so when I learned about the offering from &lt;a href="https://homely.no">Homely&lt;/a>, I was intrigued.&lt;/p>
&lt;p>Basically you own your own components, and pay a monthly fee for monitoring. The components
are mostly &lt;code>Zigbee&lt;/code>-based, and there&amp;rsquo;s a home assistant integration to get the status into my
home assistant setup, so I decided to give it a go.&lt;/p>
&lt;p>That was about 3 months ago, and our agreement with sector alarm finally expired last week, so
I&amp;rsquo;ve been busy replacing the old components with the new ones. The new components are mostly smaller
and nicer looking, it&amp;rsquo;s all paired to their proprietary hub, and it&amp;rsquo;s all managed through their app.&lt;/p>
&lt;p>Pairing through QR code mostly worked OK, even tho it sometimes took quite a while to find the devices.
I think the app is some sort of web-view, and it&amp;rsquo;s not the most responsive thing in the world, but it
mostly works OK. We have two Yale Doorman components, and after factory resetting the door locks, they
also integrated nicely with the new &lt;code>Zigbee&lt;/code> modules. I think the integration with the door locks could
be better.&lt;/p>
&lt;p>You have to set door codes separately for each door lock, but now that it&amp;rsquo;s done, it&amp;rsquo;s working
OK, and you can configure it so unlocking a door disables the alarm. Next up is running a test of the installation to
check that all the sensors are working as expected, and then setting up the home assistant integration.&lt;/p>
&lt;p>They support a list of components, and I think it&amp;rsquo;s possible to use other &lt;code>Zigbee&lt;/code> devices, but I haven&amp;rsquo;t
tested yet. Honestly I wish they had some way of integrating with my existing &lt;code>Zigbee&lt;/code> network, for instance
by having a &lt;code>MQTT&lt;/code> interface, but I guess that&amp;rsquo;s not their target audience.&lt;/p>
&lt;p>Will report back when we have some more experience with the system, but all in all, I&amp;rsquo;m happy with the
experience so far, specially the savings on the monthly fee.&lt;/p></description></item><item><title>Lazy days</title><link>https://marcus.means.no/post/2023-08-04-lazy-days/</link><pubDate>Fri, 04 Aug 2023 11:08:16 +0200</pubDate><author>marcus@means.no - Marcus Ramberg</author><guid>https://marcus.means.no/post/2023-08-04-lazy-days/</guid><description>&lt;figure>&lt;img src="https://marcus.means.no/images/2023-08-04-Lazy-days.jpg"
alt="Lazy days" width="1280">
&lt;/figure></description></item><item><title>Making your own binary format</title><link>https://marcus.means.no/post/2023-06-11-making-your-own-binary-format/</link><pubDate>Sun, 11 Jun 2023 23:24:36 +0200</pubDate><author>marcus@means.no - Marcus Ramberg</author><guid>https://marcus.means.no/post/2023-06-11-making-your-own-binary-format/</guid><description>&lt;p>I learned a lot from this article detailing how to make your own &lt;code>.com&lt;/code> executable format for Linux. Also loved this
little nugget:&lt;/p>
&lt;blockquote>
&lt;p>All these others are just sitting around, neglected. We should start using them more. I mean, why not? Heck,
put emojis in your filenames. I&amp;rsquo;m not your dad.
Alan, if you&amp;rsquo;re reading this: I forbid you to put emojis in your filenames&lt;/p>&lt;/blockquote></description></item><item><title>nixOS for the impatient</title><link>https://marcus.means.no/post/2023-06-10-nixos-for-the-impatient/</link><pubDate>Sat, 10 Jun 2023 09:05:21 +0200</pubDate><author>marcus@means.no - Marcus Ramberg</author><guid>https://marcus.means.no/post/2023-06-10-nixos-for-the-impatient/</guid><description>&lt;p>Nice pragmatic intro to my favorite Linux distribution.&lt;/p></description></item><item><title>Parsing QR codes by hand</title><link>https://marcus.means.no/post/2023-06-03-parsing-qr-codes-by-hand-/</link><pubDate>Sat, 03 Jun 2023 13:22:55 +0200</pubDate><author>marcus@means.no - Marcus Ramberg</author><guid>https://marcus.means.no/post/2023-06-03-parsing-qr-codes-by-hand-/</guid><description>&lt;p>Excellent deep dive on how QR codes work. Kinda tempted to get a QR code tattoo. Question is, what should it say. ðŸ™ˆ&lt;/p></description></item><item><title>Magic eraser is kinda crazy</title><link>https://marcus.means.no/post/2023-06-03-magic-eraser-is-kinda-crazy-/</link><pubDate>Sat, 03 Jun 2023 00:13:01 +0200</pubDate><author>marcus@means.no - Marcus Ramberg</author><guid>https://marcus.means.no/post/2023-06-03-magic-eraser-is-kinda-crazy-/</guid><description>&lt;figure>&lt;img src="https://marcus.means.no/images/2023-06-03-Magic-eraser-is-kinda-crazy-.jpg"
alt="Magic eraser is kinda crazy " width="1280">
&lt;/figure></description></item><item><title>Fixing Annoying Flashing With YouTube When Using an AppleTV With LG OLED TV</title><link>https://marcus.means.no/post/2023-05-30-fixing-annoying-flashing-with-youtube-when-using-an-appletv-with-lg-oled-tv/</link><pubDate>Tue, 30 May 2023 00:00:00 +0000</pubDate><author>marcus@means.no - Marcus Ramberg</author><guid>https://marcus.means.no/post/2023-05-30-fixing-annoying-flashing-with-youtube-when-using-an-appletv-with-lg-oled-tv/</guid><description>&lt;p>So for the longest time I&amp;rsquo;ve been annoyed with black flashing whenever I&amp;rsquo;m watching YouTube videos or shorts on
my AppleTV. I assumed this was related to the black screen between videos, but it turned out this assumption is
wrong! I had set the default output to 4K Dolby Vision, and to adjust to content, but that&amp;rsquo;s sub-optimal. There
is no need to run all your menus and such in Dolby Vision. Instead, set AppleTV to use 4K SDR, and it will
automatically turn on Dolby Vision whenever your content supports it. TIL.
(&lt;a href="https://www.reddit.com/r/LGOLED/comments/w81fwg/tv_on_then_black_screen_then_picture_pops_back_up/">Source&lt;/a>)&lt;/p></description></item><item><title>Promexplorer</title><link>https://marcus.means.no/post/2023-05-19-promexplorer/</link><pubDate>Fri, 19 May 2023 00:00:00 +0000</pubDate><author>marcus@means.no - Marcus Ramberg</author><guid>https://marcus.means.no/post/2023-05-19-promexplorer/</guid><description>&lt;h2 id="introducing-promexplorer-a-tool-for-prometheus-metrics-navigation">Introducing Promexplorer: A Tool for Prometheus Metrics Navigation&lt;/h2>
&lt;p>As software developers, we&amp;rsquo;re constantly inundated with an immense quantity of data and metrics. The influx of
information can sometimes be overwhelming, particularly when you need to sift through a multitude of metrics and
labels. That&amp;rsquo;s precisely why I developed &lt;strong>Promexplorer&lt;/strong> â€” a tool designed to simplify your interaction with
Prometheus exporter feeds.&lt;/p>
&lt;h2 id="simplifying-prometheus-metrics">Simplifying Prometheus Metrics&lt;/h2>
&lt;p>Prometheus is a staple in the open-source community, recognized for its robust metrics collection and alerting system.
It&amp;rsquo;s a powerful tool, but navigating some of the larger exporters can sometimes feel like traversing an intricate labyrinth.&lt;/p>
&lt;p>With Promexplorer, I wanted to offer a simpler way to manage this data. By aggregating all the labels into one metric,
and allowing you to filter and navigate between pages, Promexplorer provides a straightforward text user interface
(TUI) that allows you to navigate the available metrics seamlessly.&lt;/p>
&lt;h2 id="quick-and-easy-setup">Quick and Easy Setup&lt;/h2>
&lt;p>Promexplorer aims to offer ease of installation alongside its simplicity of use. I&amp;rsquo;ve provided static binaries for
macOS, Linux, and Windows. Simply download the appropriate binary from the latest release and place it in your PATH.
It&amp;rsquo;s also available as a nix package.&lt;/p>
&lt;p>The usage is equally uncomplicated:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-sh" data-lang="sh">&lt;span style="display:flex;">&lt;span>â¯ ./promexplorer http://localhost:9100/metrics
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Just by running this command, you can explore your metrics in the TUI with ease.&lt;/p>
&lt;p>in addition to http Promexplorer also supports https and file URLs,&lt;/p>
&lt;p>Here&amp;rsquo;s a quick demo of Promexplorer, which illustrates the TUI navigation.&lt;/p>
&lt;p>&lt;img src="https://github.com/marcusramberg/promexplorer/blob/main/promexplorer.gif?raw=true" alt="screen-cast">&lt;/p>
&lt;p>To get started, check out the &lt;a href="https://github.com/marcusramberg/promexplorer">Promexplorer repository&lt;/a>. If you have
any troubles please open a issue there.&lt;/p></description></item><item><title>Manage Hugo With Devenv</title><link>https://marcus.means.no/post/2023-05-18-manage-hugo-with-devenv/</link><pubDate>Thu, 18 May 2023 00:00:00 +0000</pubDate><author>marcus@means.no - Marcus Ramberg</author><guid>https://marcus.means.no/post/2023-05-18-manage-hugo-with-devenv/</guid><description>&lt;p>&lt;a href="https://devenv.sh">&lt;code>Devenv&lt;/code>&lt;/a> is a nice tool for maintaining your dev environments, spinning up servers, adding
&lt;code>pre-commit&lt;/code>-commit hooks and so on. I&amp;rsquo;ve been using a bit for maintaining my
&lt;a href="https://github.com/marcusramberg/nix-config">&lt;code>nix-config&lt;/code>&lt;/a>, as well as some work projects, so while reviving my blog from
it&amp;rsquo;s slumber, I figured I could use it to improve my setup a bit.&lt;/p>
&lt;p>&lt;code>Devenv&lt;/code> uses &lt;code>direnv&lt;/code> to install required packages when you enter the project, so we can as least use it to install
&lt;code>Hugo&lt;/code>. Also, a spell checking dictionary could be handy?&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-nix" data-lang="nix">&lt;span style="display:flex;">&lt;span> packages &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">with&lt;/span> pkgs; [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> hunspellDicts&lt;span style="color:#f92672">.&lt;/span>en_US
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Hugo
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ];
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>I normally use &lt;code>en_DK&lt;/code> as my locale, so in order to get the spellchecking to work we can also override the locale:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-nix" data-lang="nix">&lt;span style="display:flex;">&lt;span> env&lt;span style="color:#f92672">.&lt;/span>LANG &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;en_US.UTF-8&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>And the last piece is hooking up pre-commit hooks for markdown linting and spell checking&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-nix" data-lang="nix">&lt;span style="display:flex;">&lt;span> pre-commit&lt;span style="color:#f92672">.&lt;/span>hooks &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> actionlint&lt;span style="color:#f92672">.&lt;/span>enable &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> hunspell&lt;span style="color:#f92672">.&lt;/span>enable &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> markdownlint&lt;span style="color:#f92672">.&lt;/span>enable &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">true&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#960050;background-color:#1e0010">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Note that I&amp;rsquo;m also running these checks in &lt;code>GitHub Actions&lt;/code> with &lt;code>devenv ci&lt;/code>, because why not? :)&lt;/p>
&lt;p>&lt;code>Devenv&lt;/code> also has a standard way of running servers:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-nix" data-lang="nix">&lt;span style="display:flex;">&lt;span> processes &lt;span style="color:#f92672">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> hugo&lt;span style="color:#f92672">.&lt;/span>exec &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;hugo serve&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>In &lt;code>Hugo&lt;/code>&amp;rsquo;s case it&amp;rsquo;s not a big deal, but it&amp;rsquo;s nice to have a standard way, specially if you want to add some extra
flags or whatever.&lt;/p></description></item><item><title>Disabling nvim autoformat on a per-repo basis</title><link>https://marcus.means.no/post/2023-05-17-selective-autoformat-lazyvim/</link><pubDate>Wed, 17 May 2023 00:00:00 +0000</pubDate><author>marcus@means.no - Marcus Ramberg</author><guid>https://marcus.means.no/post/2023-05-17-selective-autoformat-lazyvim/</guid><description>&lt;p>I&amp;rsquo;m a huge fan of Folke&amp;rsquo;s Neovim distribution &lt;a href="https://www.lazyvim.org/">lazyvim&lt;/a>. It has replaced my own custom lua
config, and reduced the time I&amp;rsquo;m spending tweaking my config by a lot.&lt;/p>
&lt;p>One nice thing is it enables format on save by default,
which is actually what I want for almost all things. However in some repos I
contribute to they frown upon this behavior, so I have to constantly remember
to turn it off with &lt;code>&amp;lt;space&amp;gt;uf&lt;/code> or suffer review comments about excessive
white-space fixes :)&lt;/p>
&lt;p>That kinda works, but I sometimes forget, and have to undo after save and turn
it off. However now I have &lt;a href="https://github.com/marcusramberg/nix-config/commit/ca25bedf9a2d5516fd8131f1c99467538f7a7ffa">a better
solution&lt;/a>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-lua" data-lang="lua">&lt;span style="display:flex;">&lt;span>vim.api.nvim_create_autocmd({ &lt;span style="color:#e6db74">&amp;#34;BufEnter&amp;#34;&lt;/span> }, {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> pattern &lt;span style="color:#f92672">=&lt;/span> vim.fn.expand(&lt;span style="color:#e6db74">&amp;#34;~&amp;#34;&lt;/span>) &lt;span style="color:#f92672">..&lt;/span> &lt;span style="color:#e6db74">&amp;#34;/Source/{nimdow,nixpkgs}/*&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> callback &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">function&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> vim.b.autoformat &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#66d9ef">end&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>})
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Add this to &lt;code>autocmd.lua&lt;/code> and whenever you enter a buffer inside &lt;code>nimdow&lt;/code> or &lt;code>nixpkgs&lt;/code>
it automatically turns off autoformat. Note how I&amp;rsquo;m expanding ~ in this scenario
rather than putting in &lt;code>/home/marcus&lt;/code> to ensure it works on MacOs as well as Linux.&lt;/p></description></item><item><title>Enabled comments support with giscus.</title><link>https://marcus.means.no/post/2023-03-20-comments/</link><pubDate>Wed, 22 Mar 2023 00:00:00 +0000</pubDate><author>marcus@means.no - Marcus Ramberg</author><guid>https://marcus.means.no/post/2023-03-20-comments/</guid><description>&lt;p>I&amp;rsquo;ve now enabled comments on this site based on &lt;a href="https://giscus.app/">giscus&lt;/a>.&lt;/p>
&lt;h2 id="this-is-an-experiment-and-if-i-drown-in-spam-it-will-go-away-again-">This is an experiment, and if I drown in spam it will go away again. ðŸ˜…&lt;/h2></description></item><item><title>WorkingCopy adds openai generated commit messages</title><link>https://marcus.means.no/post/2023-03-06-workingcopy-adds-openai-generated-commit-messages/</link><pubDate>Mon, 06 Mar 2023 17:09:38 +0100</pubDate><author>marcus@means.no - Marcus Ramberg</author><guid>https://marcus.means.no/post/2023-03-06-workingcopy-adds-openai-generated-commit-messages/</guid><description>&lt;figure>&lt;img src="https://marcus.means.no/images/2023-03-06-WorkingCopy-adds-openai-generated-commit-messages.jpg"
alt="WorkingCopy adds openai generated commit messages" width="1280">
&lt;/figure></description></item><item><title>Conference report FOSDEM 2023</title><link>https://marcus.means.no/post/2023-02-07-fosdem-2023-conference-report/</link><pubDate>Mon, 06 Feb 2023 14:54:34 +0200</pubDate><author>marcus@means.no - Marcus Ramberg</author><guid>https://marcus.means.no/post/2023-02-07-fosdem-2023-conference-report/</guid><description>&lt;p>I was really happy to be back in Brussels finally, after some cancelled years due to Covid.
The official beer event at Delirium was still cancelled, but a bunch of us still
gathered there on Friday afternoon. Was great to see old friends from the Open Source
community, but I still managed to get to the ULB on Saturday morning in time for my first talk.&lt;/p>
&lt;h2 id="saturday">Saturday&lt;/h2>
&lt;h2 id="drawing-k8s-the-right-way">Drawing k8s the right way&lt;/h2>
&lt;p>Not a mind blowing beginning, but some nice suggestions for diagramming Kubernetes clusters,
like shaded boxes/color usage, creating things as zones rather than graphs with lines,
and to be sparing with the official icon set, as they are very sharp. Also a good suggestion,
split up a complicated drawing into two simpler ones.&lt;/p>
&lt;h3 id="send-in-the-chownss">Send in the chowns()s&lt;/h3>
&lt;p>This talk was a lot more low level, covering how OpenShift and eventually k8s is adding support
for virtual uid ranges mapped into the host user ids through the use of Linux user namespaces.
This allows things like safely running systemd inside a docker container for legacy apps.
Hoping I won&amp;rsquo;t need this, but still an interesting talk.&lt;/p>
&lt;h3 id="dagger-ci-in-go">Dagger CI in Go&lt;/h3>
&lt;p>This one is quite interesting. Dagger is a portable CI toolkit by the creators of Docker.
I&amp;rsquo;ve tracked this earlier but dismissed it due to introducing an obscure DSL (Cue), but
in the meantime they&amp;rsquo;ve introduced native SDKs to Dagger for several popular languages
including Go, Node and Python. This talk was about the Go variant, and it seems
rather usable despite a failed live demo,and provides some convenient functionality for
caching and using containers to create an isolated CI run that&amp;rsquo;s the same across your laptop
and the CI runtime env.&lt;/p>
&lt;h3 id="delve---debugging-go-with-ebpf">Delve - Debugging go with eBPF&lt;/h3>
&lt;p>This talk was about recent developments in the go debugger Delve. I def need to set this up
for my neovim config. However the most interesting part of the talk was covering the new
eBPF backend for tracing. It&amp;rsquo;s a lot faster than the existing ptrace backend, and in
some cases you can go from seconds of overhead to microseconds.&lt;/p>
&lt;h3 id="tinygoorgbluetooth">tinygo.org/bluetooth&lt;/h3>
&lt;p>This was a really funny and interesting talk about using Tinygo on embedded devices,
including lora for long range communications. They also launched a balloon the
day after to demonstrate this. Tinygo def seems like a fun time to try for my next Arduino
project.&lt;/p>
&lt;h3 id="bottlerocket">Bottlerocket&lt;/h3>
&lt;p>Bottlerocket is a container focused os for Kubernetes sponsored by AWS. It&amp;rsquo;s created to have
fast spin-up time compared to a traditional os like AWS Linux 2, and is def something I would
look at when setting up an EKS cluster for GitHub Actions. The talk went through some details on
how well protected the inner core of the os is, as well as strategies for keeping it up to date.&lt;/p>
&lt;h3 id="headscale">Headscale&lt;/h3>
&lt;p>This was my last track of the day in the Go Room. It&amp;rsquo;s about an open source implementation of
Tailscale coordination/discovery service. Their clients are actually open source, so with this
in place you can run a fully open source tailnet. Interestingly one of the contributors Kristoffer
is a Norwegian who works for Tailscale in their technical staff, and apparently they fully
support and collaborate with the Headscale project.&lt;/p>
&lt;p>The talk also has some interesting points about how they used integration tests to improve their
compatibility with the canonical implementation.&lt;/p>
&lt;p>This was my last talk of Saturday, and I spent some time attending the various booths around
the campus, as well as some delicious Belgian brews ;-)&lt;/p>
&lt;h3 id="honorable-mention-aurae">Honorable Mention: Aurae&lt;/h3>
&lt;p>I really wanted to see the talk about Aurae in the Rust track (A new distributed pid 1 for
container runners) but Unfortunately the room was packed. Luckily the recording is already
on YouTube: &lt;a href="https://www.youtube.com/watch?v=5a277u4j6fU">https://www.youtube.com/watch?v=5a277u4j6fU&lt;/a>&lt;/p>
&lt;h2 id="sunday">Sunday&lt;/h2>
&lt;p>Was back fresh and early for the first talk at 9:00 on Sunday:&lt;/p>
&lt;h3 id="async-in-python">Async in Python&lt;/h3>
&lt;p>This talk was by one of the Python core contributors, and covered a lot of details about
how async vs threads is working in Python, as well as details of the asyncio framework
included in Python3. In general this is similar to node&amp;rsquo;s promises, but yet slightly
different. One interesting asyncio function is to_thread() (Added from 3.9+) to run blocking
workloads as a separate thread in the run-loop.&lt;/p>
&lt;p>He also recommended looking at FastAPI and Tariflette / Strawberry for async python
rest / graphql frameworks.&lt;/p>
&lt;h3 id="accelerating-object-serialization">Accelerating object serialization&lt;/h3>
&lt;p>I only stayed for this talk in the Python room because I had a gap for my next talk, it was
mostly about optimizing object serialization and json serialization through low level
tricks and using the native binary representations, with some serious offsets. Tbh
it wasn&amp;rsquo;t too interesting to me, seems they should pick better tools for their job.&lt;/p>
&lt;h3 id="observability-in-postgres">Observability in Postgres&lt;/h3>
&lt;p>This talk was about using &lt;code>postgres_exporter&lt;/code> to monitor Postgres from Prometheus, which
is something we should probably look into for cloud services as well as our database traffic
grow. It was also about some future developments of a internal postgres prometheus exporter,
but this seems rather further away. Likewise it covered some potential support for postgres query
tracing for opentrace and such.&lt;/p>
&lt;h3 id="opentelemetry-with-grafana">OpenTelemetry with Grafana&lt;/h3>
&lt;p>This talk was mostly a nice overview of the main components of the Grafana Observability stack,
including Loki, Tempo, Mimir and Grafana. Mostly known things to us, but interesting to see
how things interacted, showing how you can follow a trace-id from Loki into tempo for instance
It also covered some basic of TraceQL. Held by one of the Grafana Labs Engineering managers,
and a smooth experience.&lt;/p>
&lt;h3 id="a-practical-intro-into-opentelemetry">A practical intro into OpenTelemetry&lt;/h3>
&lt;p>This talk went more into detail about how you can get OpenTelemetry collection by just
including the Agent for JDK and python services. It also covered some parts of the
added complexity for envs without a virtual machine like Rust, and mostly the same caveats
hold through for golang, which means you have to do some work to get the traces.&lt;/p>
&lt;h2 id="the-rest-of-the-sunday-i-spent-in-the-nix-track">The rest of the Sunday I spent in the Nix Track&lt;/h2>
&lt;p>Unfortunately it had a too small room without speaker and with not enough air,
so you probably will get a better experience watching the video than I did in that room.
After a quick intro we went into:&lt;/p>
&lt;h3 id="nixos-is-great">NixOS is Great&lt;/h3>
&lt;p>Which was mostly a talk about an ephemeral home-lab setup using nixOS and &lt;a href="https://github.com/danderson/netboot/tree/main/pixiecore">Pixicore&lt;/a>.
The talk was mostly focused on netbootin disk-less machines and didn&amp;rsquo;t really cover
that much nix content.&lt;/p>
&lt;h3 id="pitfalls-of-nix">Pitfalls of Nix&lt;/h3>
&lt;p>This talk was about some of the pitfalls of nix and how to avoid them. Unfortunately
he didn&amp;rsquo;t have great ideas for the high learning curve and cryptic stacktraces that
sometimes plagues nix users, other than a nice link to the awesome nix github repo
The talk also included some nice hints about using sops-nix for secrets management in
your repo to ensure secrets are kept away from the store.&lt;/p>
&lt;h3 id="make-anyone-use-nix">Make anyone use nix&lt;/h3>
&lt;p>Just a funny story about how someone made HR install nix to run their script.&lt;/p>
&lt;h3 id="nixel">Nixel&lt;/h3>
&lt;p>This talk was about using Nickel as a replacement language for nix. The nickel programming
language seems a lot more sense than nix, so they had some
compelling arguments, but it&amp;rsquo;s still missing flake support, so not quite ready
for my needs. Will be following nickel-lang/nicker-nix and hoping for quick improvements :)&lt;/p>
&lt;h3 id="playing-with-nix-in-adverse-hpc">Playing with Nix in adverse HPC&lt;/h3>
&lt;p>This talk was about university usage of nix in high performance computing. It had
some interesting ideas like letting nodes share a store with nix_store serve, as well a
using &lt;code>rpmextract&lt;/code> to repackage rpm into nix. They also wrote a simple nix-wrap script
to allow sand-boxing nix packages. Should be available with the notes on fosdem.org&lt;/p>
&lt;h3 id="contracts-for-free">Contracts for free&lt;/h3>
&lt;p>Another talk about implementing simple type checking for nix. Yants by my friend &lt;a href="https://tazj.in/">tazjin&lt;/a>
is already prior art here, and it was unclear if contracts adds any significant benefit
over just using yants. Still a cool talk :)&lt;/p>
&lt;h3 id="devenvsh">Devenv.sh&lt;/h3>
&lt;p>A talk by the devenv author, who&amp;rsquo;s also behind cachix.org and nix.dev - Was pretty
nice to see that he&amp;rsquo;s still serious about devenv, and the talk goes through some basics
of setting up a devenv for development and ci. Devenv by now supports 36 different programming
languages.&lt;/p>
&lt;h2 id="going-home">Going home&lt;/h2>
&lt;p>After that I was out of air. And spent the rest of the afternoon picking up a few stickers
and saying hi to old friends from the Perl community. All in all Fosdem 23 was a great
conference to me. One of the challenges tho with so many developer tracks is there&amp;rsquo;s always
good talks you&amp;rsquo;re missing. However luckily fosdem films most of it and publishes online, so they
will eventually all be available at &lt;a href="https://fosdem.org/">https://fosdem.org/&lt;/a> meanwhile all of the nix talks
mentioned above are already online on &lt;a href="https://www.youtube.com/playlist?list=PLCRHeqSHTVIkbMv2kDnosX3JcIT_zJuST">Youtube&lt;/a>.&lt;/p></description></item><item><title>Also why Iâ€™m always searching for golang</title><link>https://marcus.means.no/post/2022-07-25-also-why-im-always-searching-for-golang-/</link><pubDate>Mon, 25 Jul 2022 20:33:46 +0200</pubDate><author>marcus@means.no - Marcus Ramberg</author><guid>https://marcus.means.no/post/2022-07-25-also-why-im-always-searching-for-golang-/</guid><description>&lt;figure>&lt;img src="https://marcus.means.no/images/2022-07-25-Also-why-I%E2%80%99m-always-searching-for-golang-.jpg"
alt="Also why Iâ€™m always searching for golang " width="1280">
&lt;/figure></description></item><item><title>Open source feels</title><link>https://marcus.means.no/post/2022-07-19-open-source-feels/</link><pubDate>Tue, 19 Jul 2022 14:28:43 +0200</pubDate><author>marcus@means.no - Marcus Ramberg</author><guid>https://marcus.means.no/post/2022-07-19-open-source-feels/</guid><description>&lt;figure>&lt;img src="https://marcus.means.no/images/2022-07-19-Open-source-feels.jpg"
alt="Open source feels" width="1280">
&lt;/figure></description></item><item><title>Latest Arch images install cleanly in UTM</title><link>https://marcus.means.no/post/2022-04-02-latest-arch-images-install-cleanly-in-utm/</link><pubDate>Sun, 03 Apr 2022 00:00:00 +0200</pubDate><author>marcus@means.no - Marcus Ramberg</author><guid>https://marcus.means.no/post/2022-04-02-latest-arch-images-install-cleanly-in-utm/</guid><description>&lt;p>As part of a recent job change, I also acquired a M1 MBP, which is the best one I&amp;rsquo;ve had in the last 20 years. I&amp;rsquo;m
also a big fan of Linux and tiling window managers, so I was looking to have an Arch wm on the machine and be able to
use i3 and get the best of both worlds.&lt;/p>
&lt;p>Initially when I tried aarch64 didn&amp;rsquo;t install cleanly from an ISO, and the arch image UTM provides in their gallery is
problematic. (Text only, and also depends on external boot files so it starts breaking down once you sync it to latest arch).&lt;/p>
&lt;p>This latest march image installed cleanly for me with no issues as all, so I&amp;rsquo;m now the happy user of a working
graphical arch image. And running on arm arch it&amp;rsquo;s super snappy on this machine as well. Worth checking out. :)&lt;/p></description></item><item><title>Simply deploying to private GKE cluster from Cloud Build</title><link>https://marcus.means.no/post/2022-03-31-simply-deploying-to-private-gke-cluster-from-cloud-build/</link><pubDate>Thu, 31 Mar 2022 00:00:00 +0200</pubDate><author>marcus@means.no - Marcus Ramberg</author><guid>https://marcus.means.no/post/2022-03-31-simply-deploying-to-private-gke-cluster-from-cloud-build/</guid><description>&lt;p>I recently came back to Google&amp;rsquo;s Cloud Platform after some years on other cloud platforms, and as part of my work
there I had the requirement to setup a secure GCP cluster for some workloads. Google engineers have provided a nice
blueprint for this using a &lt;a href="https://registry.terraform.io/modules/terraform-google-modules/kubernetes-engine/google/latest/examples/safer_cluster_iap_bastion?tab=outputs">IAP Proxy Bastion host for external
access&lt;/a>,
which works well for safe access from developer machines and allows you to limit Identity Aware Proxy access by GCP
Security Groups.&lt;/p>
&lt;p>Basically you establish a IAP ssh tunnel to a Tinyproxy running on the bastion host, and then
set the proxy in your kube config:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>kubectl config set clusters.$context_name.proxy-url http://localhost:8888
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Of course, we also wanted to deploy to the cluster in an automated fashion, and as Cloud Build already was the CI of
choice, I set out to reach the cluster from there. Luckily Google has somewhat recently added support for &lt;a href="https://globalcloudplatforms.com/2021/08/17/introducing-cloud-build-private-pools-secure-ci-cd-for-private-networks/">private
worker
pools&lt;/a>
so in theory this should be easy. However we hit a snag. Because the workers aren&amp;rsquo;t actually running inside your VPC
and neither is the Kubernetes engine control plane, there&amp;rsquo;s a restriction on transient VPC traffic. Google
Architecture Center provides a workaround using &lt;a href="https://cloud.google.com/architecture/accessing-private-gke-clusters-with-cloud-build-private-pools">HA VPNs and separate
VPCs&lt;/a>, but I
found this to be a convoluted setup, and was worrying about maintaining a BGP routed VPN tunnel inside a single Google project.&lt;/p>
&lt;p>After digging a bit, I found a much simpler solution. Since we already have a proxy on the Bastion host, you can
simply extend it to support traffic from the builder internal network range as well. We have to add the allowed range
to Tinyproxy in the startup script:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-terraform" data-lang="terraform">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">%&lt;/span>{&lt;span style="color:#66d9ef">for&lt;/span> &lt;span style="color:#a6e22e">cidr&lt;/span> &lt;span style="color:#66d9ef">in&lt;/span> var.&lt;span style="color:#a6e22e">bastion_allowed_ranges&lt;/span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">echo&lt;/span> &lt;span style="color:#e6db74">&amp;#34;Allow &lt;/span>&lt;span style="color:#e6db74">${&lt;/span>&lt;span style="color:#a6e22e">cidr&lt;/span>&lt;span style="color:#e6db74">}&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&lt;/span> &lt;span style="color:#f92672">&amp;gt;&amp;gt;&lt;/span> &lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#a6e22e">etc&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#a6e22e">tinyproxy&lt;/span>&lt;span style="color:#f92672">/&lt;/span>&lt;span style="color:#a6e22e">tinyproxy&lt;/span>.&lt;span style="color:#a6e22e">conf&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">%&lt;/span>{&lt;span style="color:#a6e22e">endfor&lt;/span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#a6e22e">systemctl&lt;/span> &lt;span style="color:#a6e22e">restart&lt;/span> &lt;span style="color:#a6e22e">tinyproxy&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>And also add a firewall policy for the provided range(s):&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-terraform" data-lang="terraform">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#66d9ef">resource&lt;/span> &lt;span style="color:#e6db74">&amp;#34;google_compute_firewall&amp;#34;&lt;/span> &lt;span style="color:#e6db74">&amp;#34;allow_bastion&amp;#34;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">count&lt;/span> = length(var.&lt;span style="color:#a6e22e">bastion_allowed_ranges&lt;/span>) &lt;span style="color:#f92672">&amp;gt;&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#f92672">?&lt;/span> &lt;span style="color:#ae81ff">1&lt;/span> &lt;span style="color:#f92672">:&lt;/span> &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">name&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;allow-bastion-proxy&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">network&lt;/span> = module.&lt;span style="color:#a6e22e">vpc&lt;/span>.&lt;span style="color:#a6e22e">network_self_link&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">project&lt;/span> = module.&lt;span style="color:#a6e22e">enabled_google_apis&lt;/span>.&lt;span style="color:#a6e22e">project_id&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">allow&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">protocol&lt;/span> = &lt;span style="color:#e6db74">&amp;#34;tcp&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">ports&lt;/span> = [&lt;span style="color:#e6db74">&amp;#34;8888&amp;#34;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">target_tags&lt;/span> = [&lt;span style="color:#e6db74">&amp;#34;bastion&amp;#34;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#a6e22e">source_ranges&lt;/span> = var.&lt;span style="color:#a6e22e">bastion_allowed_ranges&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Now your cloud builder will be able to reach the control plane via the proxy just by setting proxy-url like in my
first example. The reason this works is that the bastion host resides inside our VPC and thus is available directly
from our cloud build pool.&lt;/p></description></item><item><title>Enabling touch-id for sudo</title><link>https://marcus.means.no/post/2022-03-27-enabling-touchid-for-sudo/</link><pubDate>Sun, 27 Mar 2022 21:31:00 +0200</pubDate><author>marcus@means.no - Marcus Ramberg</author><guid>https://marcus.means.no/post/2022-03-27-enabling-touchid-for-sudo/</guid><description>&lt;p>Somehow I missed that this is supported, but it&amp;rsquo;s awesome! Also works with Apple Watch unlock in case your
mac/keyboard doesn&amp;rsquo;t have a touch-id sensor :)&lt;/p></description></item><item><title>Type clipboard with Alfred</title><link>https://marcus.means.no/post/2021-12-09-type-clipboard-with-alfred-/</link><pubDate>Thu, 09 Dec 2021 09:14:37 +0100</pubDate><author>marcus@means.no - Marcus Ramberg</author><guid>https://marcus.means.no/post/2021-12-09-type-clipboard-with-alfred-/</guid><description>&lt;p>Ever in a situation where clipboard isn&amp;rsquo;t operational, say inside two layers of vdi for instance? This Alfred workflow
can help!&lt;/p></description></item><item><title>Ã˜stensjÃ¸vannet</title><link>https://marcus.means.no/post/2021-08-09-%C3%B8stensj%C3%B8vannet/</link><pubDate>Mon, 09 Aug 2021 20:37:08 +0200</pubDate><author>marcus@means.no - Marcus Ramberg</author><guid>https://marcus.means.no/post/2021-08-09-%C3%B8stensj%C3%B8vannet/</guid><description>&lt;figure>&lt;img src="https://marcus.means.no/images/2021-08-09-%C3%98stensj%C3%B8vannet.jpg"
alt="Ã˜stensjÃ¸vannet" width="1280">
&lt;/figure></description></item><item><title>Started a new Gaming video channel</title><link>https://marcus.means.no/post/2021-02-22-new-gaming-channel/</link><pubDate>Sat, 20 Feb 2021 19:40:00 +0100</pubDate><author>marcus@means.no - Marcus Ramberg</author><guid>https://marcus.means.no/post/2021-02-22-new-gaming-channel/</guid><description>&lt;p>First post shows first five minutes of each game in this months Humble Choice
from Humble Bundle, running under Linux.&lt;/p>
&lt;iframe id="lbry-iframe" width="560" height="315"
src="https://lbry.tv/$/embed/5min-humble-choice-02-21/89592a7802d3825c3dbb29e8b3a7dd5d8532efc8?r=3cvdSDPFnEF4PTDniNjReLdghFxjkhRJ"
allowfullscreen>&lt;/iframe>
&lt;p>More videos to come soon :) Note, the if you prefer, the channel is also
available on &lt;a href="https://www.youtube.com/watch?v=GEaKekwjvCA&amp;amp;feature=youtu.be">Youtube&lt;/a>&lt;/p></description></item><item><title>Zigbee2mqtt</title><link>https://marcus.means.no/post/2021-02-09-zigbee2mqtt/</link><pubDate>Tue, 09 Feb 2021 22:02:41 +0100</pubDate><author>marcus@means.no - Marcus Ramberg</author><guid>https://marcus.means.no/post/2021-02-09-zigbee2mqtt/</guid><description>&lt;p>&lt;figure>&lt;img src="https://marcus.means.no/images/2021-02-09-Zigbee2mqtt.jpg"
alt="Zigbee2mqtt" width="1280">
&lt;/figure>
Finished migrating all my devices from Deconz. Much nicer OTA, binding and entity management. Next up ZWave. MQTT all
the things!&lt;/p></description></item><item><title>Sandvika Ice Skaters</title><link>https://marcus.means.no/post/2021-02-01-sandvika-ice-skaters/</link><pubDate>Mon, 01 Feb 2021 00:00:00 +0100</pubDate><author>marcus@means.no - Marcus Ramberg</author><guid>https://marcus.means.no/post/2021-02-01-sandvika-ice-skaters/</guid><description>&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen="allowfullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/Z5IXau-k1oo?autoplay=0&amp;amp;controls=1&amp;amp;end=0&amp;amp;loop=0&amp;amp;mute=0&amp;amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video">&lt;/iframe>
&lt;/div>
&lt;p>I shot this with my DJI Mavic Pro in 4K. Unusual that it&amp;rsquo;s cold enough in Oslo for this to be possible.&lt;/p></description></item><item><title>Homemade chicken nuggets</title><link>https://marcus.means.no/post/2021-01-18-homemade-chicken-nuggets-/</link><pubDate>Mon, 18 Jan 2021 23:41:21 +0100</pubDate><author>marcus@means.no - Marcus Ramberg</author><guid>https://marcus.means.no/post/2021-01-18-homemade-chicken-nuggets-/</guid><description>&lt;figure>&lt;img src="https://marcus.means.no/images/2021-01-18-Homemade-chicken-nuggets-.jpg"
alt="Homemade chicken nuggets " width="1280">
&lt;/figure></description></item></channel></rss>